---
import { getCollection, type CollectionEntry } from 'astro:content';
import Layout from '../../layouts/Layout.astro';
import { ArticleCard } from '../../components/kenniscentrum/ArticleCard';
import { Calendar, Clock, User, ArrowLeft, Share2, Twitter, Linkedin, Facebook, Tag } from 'lucide-react';
import { Badge } from '../../components/ui/badge';

export async function getStaticPaths() {
  const artikelen = await getCollection('artikelen');
  return artikelen.map((artikel) => ({
    params: { slug: artikel.slug },
    props: { artikel },
  }));
}

interface Props {
  artikel: CollectionEntry<'artikelen'>;
}

const { artikel } = Astro.props;
const { Content } = await artikel.render();

// Get related articles (same category, different article)
const allArtikelen = await getCollection('artikelen');
const relatedArtikelen = allArtikelen
  .filter(a => a.slug !== artikel.slug && a.data.category === artikel.data.category)
  .slice(0, 3);

const formatDate = (date: Date) => {
  return new Intl.DateTimeFormat('nl-NL', {
    year: 'numeric',
    month: 'long',
    day: 'numeric'
  }).format(date);
};

const categoryLabels = {
  'ai-trends': 'AI Trends',
  'case-studies': 'Case Studies',
  'tutorials': 'Tutorials', 
  'thought-leadership': 'Thought Leadership',
  'company-updates': 'Company Updates'
};

const categoryColors = {
  'ai-trends': 'bg-blue-500/10 text-blue-400 border-blue-500/20',
  'case-studies': 'bg-green-500/10 text-green-400 border-green-500/20',
  'tutorials': 'bg-purple-500/10 text-purple-400 border-purple-500/20',
  'thought-leadership': 'bg-orange-500/10 text-orange-400 border-orange-500/20',
  'company-updates': 'bg-gray-500/10 text-gray-400 border-gray-500/20'
};

// SEO data
const seoTitle = artikel.data.seo?.metaTitle || artikel.data.title;
const seoDescription = artikel.data.seo?.metaDescription || artikel.data.description;
const seoKeywords = artikel.data.seo?.keywords || artikel.data.tags;
---

<Layout 
  title={`${seoTitle} | Buildrs AI Kenniscentrum`}
  description={seoDescription}
>
  <main class="min-h-screen bg-black text-white">
    
    <!-- Article Header -->
    <header class="relative py-12 px-4 overflow-hidden">
      <div class="absolute inset-0 bg-gradient-to-br from-blue-900/10 via-black to-purple-900/10"></div>
      
      <!-- Background Pattern -->
      <div class="absolute inset-0 opacity-5">
        <div class="absolute top-10 left-10 w-32 h-32 rounded-full bg-blue-500/20 blur-xl"></div>
        <div class="absolute top-40 right-20 w-24 h-24 rounded-full bg-purple-500/20 blur-xl"></div>
      </div>

      <div class="relative max-w-4xl mx-auto">
        <!-- Breadcrumb -->
        <nav class="mb-8">
          <a 
            href="/kenniscentrum" 
            class="inline-flex items-center text-gray-400 hover:text-white transition-colors duration-200"
          >
            <ArrowLeft class="w-4 h-4 mr-2" />
            Terug naar kenniscentrum
          </a>
        </nav>

        <!-- Category and Tags -->
        <div class="flex flex-wrap items-center gap-3 mb-6">
          <Badge 
            class={`text-sm ${categoryColors[artikel.data.category as keyof typeof categoryColors]}`}
          >
            {categoryLabels[artikel.data.category as keyof typeof categoryLabels]}
          </Badge>
          
          {artikel.data.tags.slice(0, 3).map((tag) => (
            <Badge variant="outline" class="text-sm bg-gray-500/10 text-gray-400 border-gray-500/20">
              <Tag class="w-3 h-3 mr-1" />
              {tag}
            </Badge>
          ))}
        </div>

        <!-- Title -->
        <h1 class="text-3xl md:text-5xl lg:text-6xl font-bold mb-6 leading-tight bg-gradient-to-r from-white via-blue-200 to-purple-200 bg-clip-text text-transparent">
          {artikel.data.title}
        </h1>

        <!-- Description -->
        <p class="text-xl md:text-2xl text-gray-300 mb-8 leading-relaxed">
          {artikel.data.description}
        </p>

        <!-- Article Meta -->
        <div class="flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-8">
          <div class="flex items-center space-x-6 text-gray-400">
            <div class="flex items-center">
              <User class="w-5 h-5 mr-2" />
              <span class="font-medium">{artikel.data.author}</span>
            </div>
            <div class="flex items-center">
              <Calendar class="w-5 h-5 mr-2" />
              <span>{formatDate(artikel.data.publishDate)}</span>
            </div>
            {artikel.data.readingTime && (
              <div class="flex items-center">
                <Clock class="w-5 h-5 mr-2" />
                <span>{artikel.data.readingTime} min leestijd</span>
              </div>
            )}
          </div>

          <!-- Share Buttons -->
          <div class="flex items-center space-x-3">
            <span class="text-sm text-gray-400 mr-2">Delen:</span>
            <button class="p-2 bg-blue-500/10 text-blue-400 rounded-lg hover:bg-blue-500/20 transition-colors duration-200">
              <Twitter class="w-5 h-5" />
            </button>
            <button class="p-2 bg-blue-500/10 text-blue-400 rounded-lg hover:bg-blue-500/20 transition-colors duration-200">
              <Linkedin class="w-5 h-5" />
            </button>
            <button class="p-2 bg-blue-500/10 text-blue-400 rounded-lg hover:bg-blue-500/20 transition-colors duration-200">
              <Facebook class="w-5 h-5" />
            </button>
          </div>
        </div>
      </div>
    </header>

    <!-- Article Content -->
    <article class="py-12 px-4">
      <div class="max-w-4xl mx-auto">
        {artikel.data.image && (
          <div class="mb-12 rounded-xl overflow-hidden">
            <img 
              src={artikel.data.image.src} 
              alt={artikel.data.image.alt}
              class="w-full h-64 md:h-96 object-cover"
            />
          </div>
        )}

        <!-- Article Body -->
        <div class="prose prose-lg prose-invert max-w-none">
          <Content />
        </div>
      </div>
    </article>

    <!-- Article Footer -->
    <footer class="py-12 px-4 bg-white/5">
      <div class="max-w-4xl mx-auto">
        <!-- Tags -->
        <div class="mb-8">
          <h3 class="text-lg font-semibold mb-4">Tags</h3>
          <div class="flex flex-wrap gap-3">
            {artikel.data.tags.map((tag) => (
              <a 
                href={`/kenniscentrum/tag/${tag.toLowerCase().replace(/\s+/g, '-')}`}
                class="px-4 py-2 bg-black/40 backdrop-blur-sm border border-white/10 rounded-full text-gray-300 hover:text-white hover:border-blue-500/30 hover:bg-black/60 transition-all duration-200 text-sm"
              >
                #{tag}
              </a>
            ))}
          </div>
        </div>

        <!-- Author Bio -->
        <div class="mb-12 p-6 bg-black/40 backdrop-blur-sm border border-white/10 rounded-xl">
          <div class="flex items-center gap-4">
            <div class="w-16 h-16 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center">
              <User class="w-8 h-8 text-white" />
            </div>
            <div>
              <h3 class="text-xl font-semibold text-white">{artikel.data.author}</h3>
              <p class="text-gray-400">AI Specialist & Founder @ Buildrs AI</p>
              <p class="text-sm text-gray-300 mt-2">
                Expert in AI-implementatie voor MKB-bedrijven. Helpt organisaties bij het succesvol transformeren van hun business processen met praktische AI-oplossingen.
              </p>
            </div>
          </div>
        </div>
      </div>
    </footer>

    <!-- Related Articles -->
    {relatedArtikelen.length > 0 && (
      <section class="py-16 px-4">
        <div class="max-w-6xl mx-auto">
          <h2 class="text-2xl md:text-3xl font-semibold mb-8 text-center">
            Gerelateerde Artikelen
          </h2>
          
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            {relatedArtikelen.map((gerelateerd) => (
              <a href={`/kenniscentrum/${gerelateerd.slug}`} class="block">
                <ArticleCard 
                  client:load
                  title={gerelateerd.data.title}
                  description={gerelateerd.data.description}
                  author={gerelateerd.data.author}
                  publishDate={gerelateerd.data.publishDate}
                  category={gerelateerd.data.category}
                  tags={gerelateerd.data.tags}
                  readingTime={gerelateerd.data.readingTime}
                  image={gerelateerd.data.image}
                  featured={gerelateerd.data.featured}
                  slug={gerelateerd.slug}
                />
              </a>
            ))}
          </div>
        </div>
      </section>
    )}

    <!-- CTA Section -->
    <section class="py-16 px-4 bg-gradient-to-r from-blue-900/20 via-purple-900/20 to-blue-900/20">
      <div class="max-w-4xl mx-auto text-center">
        <h2 class="text-3xl md:text-4xl font-semibold mb-4 bg-gradient-to-r from-white via-blue-200 to-purple-200 bg-clip-text text-transparent">
          Klaar om AI in jouw bedrijf te implementeren?
        </h2>
        <p class="text-xl text-gray-300 mb-8 max-w-2xl mx-auto">
          Plan een gratis deepdive sessie en ontdek hoe AI jouw business kan transformeren.
        </p>
        
        <a 
          href="/contact"
          class="inline-flex items-center px-8 py-4 bg-blue-600 hover:bg-blue-700 text-white rounded-full font-semibold transition-all duration-200 hover:shadow-lg hover:shadow-blue-600/25 hover:scale-105"
        >
          Plan je gratis AI Assessment
          <svg class="w-5 h-5 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
          </svg>
        </a>
      </div>
    </section>

  </main>
</Layout>

<style>
  /* Custom prose styles for article content */
  .prose {
    color: #e5e7eb;
  }
  
  .prose h1, .prose h2, .prose h3, .prose h4, .prose h5, .prose h6 {
    color: #ffffff;
    font-weight: 600;
    margin-top: 2rem;
    margin-bottom: 1rem;
  }
  
  .prose h1 {
    font-size: 2.5rem;
    line-height: 1.2;
  }
  
  .prose h2 {
    font-size: 2rem;
    line-height: 1.3;
    border-bottom: 1px solid #374151;
    padding-bottom: 0.5rem;
  }
  
  .prose h3 {
    font-size: 1.5rem;
    line-height: 1.4;
    color: #60a5fa;
  }
  
  .prose p {
    margin-bottom: 1.5rem;
    line-height: 1.7;
  }
  
  .prose strong {
    color: #ffffff;
    font-weight: 600;
  }
  
  .prose a {
    color: #60a5fa;
    text-decoration: none;
    border-bottom: 1px solid transparent;
    transition: border-color 0.2s ease;
  }
  
  .prose a:hover {
    border-bottom-color: #60a5fa;
  }
  
  .prose ul, .prose ol {
    margin: 1.5rem 0;
    padding-left: 1.5rem;
  }
  
  .prose li {
    margin-bottom: 0.5rem;
    line-height: 1.6;
  }
  
  .prose blockquote {
    border-left: 4px solid #60a5fa;
    padding-left: 1.5rem;
    margin: 2rem 0;
    font-style: italic;
    color: #d1d5db;
    background: rgba(59, 130, 246, 0.05);
    padding: 1.5rem;
    border-radius: 0.5rem;
  }
  
  .prose code {
    background: rgba(59, 130, 246, 0.1);
    color: #93c5fd;
    padding: 0.2rem 0.4rem;
    border-radius: 0.25rem;
    font-size: 0.875rem;
  }
  
  .prose pre {
    background: #111827;
    border: 1px solid #374151;
    border-radius: 0.5rem;
    padding: 1.5rem;
    overflow-x: auto;
    margin: 2rem 0;
  }
  
  .prose pre code {
    background: none;
    color: #e5e7eb;
    padding: 0;
  }
  
  .prose table {
    width: 100%;
    border-collapse: collapse;
    margin: 2rem 0;
    background: rgba(0, 0, 0, 0.3);
    border-radius: 0.5rem;
    overflow: hidden;
  }
  
  .prose th, .prose td {
    border: 1px solid #374151;
    padding: 0.75rem 1rem;
    text-align: left;
  }
  
  .prose th {
    background: rgba(59, 130, 246, 0.1);
    color: #ffffff;
    font-weight: 600;
  }
  
  .prose tr:nth-child(even) {
    background: rgba(255, 255, 255, 0.02);
  }
  
  .prose img {
    border-radius: 0.5rem;
    margin: 2rem 0;
    width: 100%;
    height: auto;
  }
  
  /* Custom checkboxes for task lists */
  .prose input[type="checkbox"] {
    accent-color: #60a5fa;
    margin-right: 0.5rem;
  }
  
  .prose .task-list-item {
    list-style: none;
    margin-left: -1.5rem;
    padding-left: 1.5rem;
  }
</style>