/* Advanced Image Performance Optimizations */

/* Ultra-smooth GPU acceleration for all sections and images */
.hero-section,
.platform-section,
.marketing-section,
.use-case-section,
section[class*="bg-"],
div[style*="background-image"],
img[class*="hero"],
img[class*="platform"],
img[class*="marketing"],
section,
main {
  transform: translate3d(0, 0, 0);
  backface-visibility: hidden;
  will-change: transform, opacity;
  contain: layout style paint;
  -webkit-transform: translate3d(0, 0, 0);
  -webkit-backface-visibility: hidden;
}

/* Ultra-smooth scroll containers */
html {
  scroll-behavior: smooth;
  -webkit-overflow-scrolling: touch;
}

body {
  transform: translate3d(0, 0, 0);
  backface-visibility: hidden;
  -webkit-transform: translate3d(0, 0, 0);
  -webkit-backface-visibility: hidden;
}

/* Force compositing layers for smooth scrolling */
section > div {
  transform: translate3d(0, 0, 0);
  backface-visibility: hidden;
  will-change: transform;
}

/* Prevent layout shifts with container queries */
@supports (container-type: inline-size) {
  .image-container {
    container-type: inline-size;
  }
  
  @container (min-width: 768px) {
    .responsive-image {
      object-position: center 25%;
    }
  }
}

/* Anti-flicker scroll optimization */
.scroll-optimized {
  contain: layout style paint;
  content-visibility: auto;
  contain-intrinsic-size: 100% 50vh;
}

/* Pause transitions during fast scroll to prevent flicker */
.fast-scrolling * {
  transition-duration: 0s !important;
  animation-duration: 0s !important;
}

.fast-scrolling img,
.fast-scrolling [style*="background-image"] {
  image-rendering: optimizeSpeed;
}

/* Resume normal transitions when scroll stops */
.scroll-stable * {
  transition-duration: revert;
  animation-duration: revert;
}

/* Optimize for high-refresh displays */
@media (prefers-reduced-motion: no-preference) {
  .smooth-scroll {
    transform-style: preserve-3d;
    will-change: transform;
  }
}

/* Critical resource hints */
.preload-critical {
  content-visibility: auto;
  contain-intrinsic-size: 100vw 100vh;
}

/* Intersection observer targets */
[data-observe] {
  content-visibility: auto;
  contain-intrinsic-size: 100% 50vh;
}

/* Background image performance */
.bg-image-container {
  background-attachment: scroll; /* Better performance than fixed */
  background-repeat: no-repeat;
  background-size: cover;
  transform: translateZ(0);
  will-change: transform, opacity;
}

/* Premium image loading states with smooth transitions */
.image-loading {
  opacity: 0;
  transition: opacity 0.7s cubic-bezier(0.4, 0, 0.2, 1);
  will-change: opacity;
}

.image-loaded {
  opacity: 1;
}

/* Blur-to-clear progressive loading */
.progressive-image {
  position: relative;
  overflow: hidden;
}

.progressive-image-thumbnail {
  position: absolute;
  inset: 0;
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  filter: blur(10px);
  transform: scale(1.05);
  transition: opacity 0.5s ease-out;
  z-index: 1;
}

.progressive-image-main {
  position: absolute;
  inset: 0;
  opacity: 0;
  transition: opacity 0.7s cubic-bezier(0.4, 0, 0.2, 1);
  z-index: 2;
  backface-visibility: hidden;
  transform: translateZ(0);
}

.progressive-image-main.loaded {
  opacity: 1;
}

.progressive-image-main.loaded + .progressive-image-thumbnail {
  opacity: 0;
}

/* Advanced aspect ratio preservation */
.aspect-16-9 {
  aspect-ratio: 16/9;
}

.aspect-4-3 {
  aspect-ratio: 4/3;
}

.aspect-1-1 {
  aspect-ratio: 1/1;
}

.aspect-1-1-5 {
  aspect-ratio: 1/1.5;
}

/* Force compositing layers for smoother animations */
.composite-layer {
  transform: translateZ(0);
  backface-visibility: hidden;
  perspective: 1000;
}

/* High-performance scroll snap */
.scroll-container {
  scroll-snap-type: y mandatory;
  overscroll-behavior: contain;
}

.scroll-section {
  scroll-snap-align: start;
  scroll-snap-stop: always;
}

/* Browser-specific optimizations */
@supports (-webkit-appearance: none) {
  /* Safari/WebKit specific optimizations */
  .webkit-optimize {
    -webkit-backface-visibility: hidden;
    -webkit-transform: translateZ(0);
    -webkit-font-smoothing: antialiased;
  }
}

/* Firefox specific optimizations */
@-moz-document url-prefix() {
  .moz-optimize {
    image-rendering: -moz-crisp-edges;
    image-rendering: crisp-edges;
  }
}

/* Chromium specific optimizations */
@supports (image-rendering: pixelated) {
  .chrome-optimize {
    image-rendering: -webkit-optimize-contrast;
    image-rendering: optimize-contrast;
  }
}